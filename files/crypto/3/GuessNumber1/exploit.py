from pwn import *

p=remote('gtn1.challs.cyberchallenge.it', 9060)
p.recvuntil(b"= ")
m=int(p.recvuntil(b"\n",True))
p.recvuntil(b"= ")
c=int(p.recvuntil(b"\n",True))
p.recvuntil(b"= ")
n=int(p.recvuntil(b"\n",True))
p.recvuntil(b"= ")
s=int(p.recvuntil(b"\n",True))
print(m,c,n,s)
while(True):
    next_s=pow(s*m+c,1,n)
    p.sendline(str(next_s).encode())
    s=next_s
    print(p.recv(2000))
#print(p.recvuntil(b"v[0]"))

    