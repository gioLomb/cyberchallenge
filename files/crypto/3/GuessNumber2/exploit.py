from pwn import *

# Connessione all'endpoint remoto
p = remote('gtn1.challs.cyberchallenge.it', 9061)

# Lettura dei parametri
p.recvuntil(b"= ")
m = int(p.recvuntil(b"\n", True))
p.recvuntil(b"= ")
n = int(p.recvuntil(b"\n", True))
p.recvuntil(b"[0] = ")
v0 = int(p.recvuntil(b"\n", True))
p.recvuntil(b"[1] = ")
v1 = int(p.recvuntil(b"\n", True))

print(f"Ricevuto: m={m}, n={n}, v0={v0}, v1={v1}")

# Calcolo di c
c = (v1 - (m * v0)) % n
print(f"Calcolato: c={c}")

# Invio dei numeri generati
s = v1  # Ultimo valore noto
while True:
    next_s = (m * s + c) % n  # Genera il prossimo numero
    p.sendline(str(next_s).encode())  # Invia il valore al server
    s = next_s  # Aggiorna il valore corrente
    response = p.recv(2000)  # Riceve la risposta del server
    print(response.decode())  # Stampa la risposta

p.interactive()  # Sblocca la shell interattiva se necessario
